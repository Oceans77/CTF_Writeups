# SOME TRAFFIC

Challenge Description:
> We are sinking! The nearest ship got our SOS call, but they replied in pure gobbledygook! Are ye savvy enough to decode the message, or will we be sleepin' with the fish tonight? All hands on deck! 
> Whiskey Hotel Four Tango Dash Alpha Romeo Three Dash Yankee Oscar Uniform Dash Sierra One November Kilo India November Golf Dash Four Bravo Zero Uniform Seven

In this one you're given a file called "[sus.pcap](https://github.com/Oceans77/CTF_Writeups/blob/main/TFC%20CTF%202023/SOME%20TRAFFIC/sus.pcapng)", Naturally this is a network capture packet file, so we can open it up in Wireshark to start looking at the data.
First thing I noticed, was the crazy amount of "Port Unreachable" packets, but also the TCP packets that were captured containing data.

![wireshark_capture](https://i.ibb.co/w0MGjhL/2023-07-29-18h03-54.png)

I followed the TCP Stream and saw data referencing PNG files.
I was able to quickly pull these images by 
1. filtering out the http packets
2. sorting by Protocol
3. opening each "PNG" packet
4. expanded MIME & Encapsulated
5. right-clicked "Portable Network Graphics"
6. Copy As Hex Stream

![wireshark_filtered_view](https://i.ibb.co/ngKpsBG/2023-07-29-18h56-37.png)

I then threw each hex stream I copied into Cyberchef which immediately converted it from hex and rendered the PNG files. The one that stuck out was this one below

![Cyberchef_converstion](https://i.ibb.co/0mWhzc7/2023-07-29-18h23-43.png)

Extracted Image:
![Extracted_Image](https://i.ibb.co/V3J006h/download.png)

Looking at the extracted image we can see these out-of-place green streaks going through it on the left side.
Using [PixSpy](https://pixspy.com/) I uploaded the image, extracted the shortest green line (the others looked identical) and cut it out of the image, saving only those pixels seperately.

Using the Pillow python library I was able to grab the decimal values of the pixels

```python
# Importing Pillow Library
from PIL import Image

# Opening and reading the image
i = image.open('image_name_here.png','r')

# #Extracting the pixel data
pix_val = list(i.getdata())

print(pix_value)
```

Output:
```text
(1, 70, 1, 255), (1, 67, 1, 255), (1, 67, 1, 255), (1, 84, 1, 255), (1, 70, 1, 255), (1, 123, 1, 255), (1, 72, 1, 255), (1, 49, 1, 255), (1, 100, 1, 255), (1, 100, 1, 255), (1, 51, 1, 255), (1, 110, 1, 255), (1, 95, 1, 255), (1, 100, 1 49, 1, 255), (1, 110, 1, 255), (1, 95, 1, 255), (1, 112, 1, 255), (1, 49, 1, 255), (1, 120, 1, 255), (1, 51, 1, 255), (1, 108, 1, 255), (1, 115, 1, 255), (1, 95, 1, 255), (1, 105, 1, 255), (1, 53, 1, 255), (1, 110, 1, 255), (1, 39, 1, 110, 1, 255), (1, 95, 1, 255), (1, 52, 1, 255), (1, 110, 1, 255), (1, 100, 1, 255), (1, 95, 1, 255), (1, 101, 1, 255), (1, 52, 1, 255), (1, 115, 1, 255), (1, 121, 1, 255), (1, 95, 1, 255), (1, 116, 1, 255), (1, 111, 1, 255), (1, 95, 1,  33, 1, 255), (1, 125, 1, 255), (1, 84, 1, 255), (1, 70, 1, 255), (1, 67, 1, 255), (1, 67, 1, 255), (1, 84, 1, 255), (1, 70, 1, 255), (1, 123, 1, 255), (1, 72, 1, 255), (1, 49, 1, 255), (1, 100, 1, 255), (1, 100, 1, 255), (1, 51, 1, 255, 1, 255), (1, 52, 1, 255), (1, 95, 1, 255), (1, 49, 1, 255), (1, 110, 1, 255), (1, 95, 1, 255), (1, 112, 1, 255), (1, 49, 1, 255), (1, 120, 1, 255), (1, 51, 1, 255), (1, 108, 1, 255), (1, 115, 1, 255), (1, 95, 1, 255), (1, 105, 1, 255)1, 255), (1, 102, 1, 255), (1, 52, 1, 255), (1, 110, 1, 255), (1, 95, 1, 255), (1, 52, 1, 255), (1, 110, 1, 255), (1, 100, 1, 255), (1, 95, 1, 255), (1, 101, 1, 255), (1, 52, 1, 255), (1, 115, 1, 255), (1, 121, 1, 255), (1, 95, 1, 255),1, 255), (1, 110, 1, 255), (1, 100, 1, 255), (1, 33, 1, 255), (1, 125, 1, 255), (1, 84, 1, 255), (1, 70, 1, 255), (1, 67, 1, 255), (1, 67, 1, 255), (1, 84, 1, 255), (1, 70, 1, 255), (1, 123, 1, 255), (1, 72, 1, 255), (1, 49, 1, 255), (1255), (1, 100, 1, 255), (1, 52, 1, 255), (1, 116, 1, 255), (1, 52, 1, 255), (1, 95, 1, 255), (1, 49, 1, 255), (1, 110, 1, 255), (1, 95, 1, 255), (1, 112, 1, 255), (1, 49, 1, 255), (1, 120, 1, 255), (1, 51, 1, 255), (1, 108, 1, 255), (1,55), (1, 39, 1, 255), (1, 116, 1, 255), (1, 95, 1, 255), (1, 102, 1, 255), (1, 52, 1, 255), (1, 110, 1, 255), (1, 95, 1, 255), (1, 52, 1, 255), (1, 110, 1, 255), (1, 100, 1, 255), (1, 95, 1, 255), (1, 101, 1, 255), (1, 52, 1, 255), (1, 55), (1, 95, 1, 255), (1, 102, 1, 255), (1, 49, 1, 255), (1, 110, 1, 255), (1, 100, 1, 255), (1, 33, 1, 255), (1, 125, 1, 255), (1, 84, 1, 255), (1, 70, 1, 255), (1, 67, 1, 255), (1, 67, 1, 255), (1, 84, 1, 255), (1, 70, 1, 255), (1, 12, (1, 51, 1, 255), (1, 110, 1, 255), (1, 95, 1, 255), (1, 100, 1, 255), (1, 52, 1, 255), (1, 116, 1, 255), (1, 52, 1, 255), (1, 95, 1, 255), (1, 49, 1, 255), (1, 110, 1, 255), (1, 95, 1, 255), (1, 112, 1, 255), (1, 49, 1, 255), (1, 120,(1, 105, 1, 255), (1, 53, 1, 255), (1, 110, 1, 255), (1, 39, 1, 255), (1, 116, 1, 255), (1, 95, 1, 255), (1, 102, 1, 255), (1, 52, 1, 255), (1, 110, 1, 255), (1, 95, 1, 255), (1, 52, 1, 255), (1, 110, 1, 255), (1, 100, 1, 255), (1, 95, (1, 95, 1, 255), (1, 116, 1, 255), (1, 111, 1, 255), (1, 95, 1, 255), (1, 102, 1, 255), (1, 49, 1, 255), (1, 110, 1, 255), (1, 100, 1, 255), (1, 33, 1, 255), (1, 125, 1, 255), (1, 84, 1, 255), (1, 70, 1, 255), (1, 67, 1, 255), (1, 67, 1 49, 1, 255), (1, 100, 1, 255), (1, 100, 1, 255), (1, 51, 1, 255), (1, 110, 1, 255), (1, 95, 1, 255), (1, 100, 1, 255), (1, 52, 1, 255), (1, 116, 1, 255), (1, 52, 1, 255), (1, 95, 1, 255), (1, 49, 1, 255), (1, 110, 1, 255), (1, 95, 1, 208, 1, 255), (1, 115, 1, 255), (1, 95, 1, 255), (1, 105, 1, 255), (1, 53, 1, 255), (1, 110, 1, 255), (1, 39, 1, 255), (1, 116, 1, 255), (1, 95, 1, 255), (1, 102, 1, 255), (1, 52, 1, 255), (1, 110, 1, 255), (1, 95, 1, 255), (1, 52, 1, 252, 1, 255), (1, 115, 1, 255), (1, 121, 1, 255), (1, 95, 1, 255), (1, 116, 1, 255), (1, 111, 1, 255), (1, 95, 1, 255), (1, 102, 1, 255), (1, 49, 1, 255), (1, 110, 1, 255), (1, 100, 1, 255), (1, 33, 1, 255), (1, 125, 1, 255), (1, 84, 1, 2 1, 255), (1, 123, 1, 255), (1, 72, 1, 255), (1, 49, 1, 255), (1, 100, 1, 255), (1, 100, 1, 255), (1, 51, 1, 255), (1, 110, 1, 255), (1, 95, 1, 255), (1, 100, 1, 255), (1, 52, 1, 255), (1, 116, 1, 255), (1, 52, 1, 255), (1, 95, 1, 255),, 255), (1, 120, 1, 255), (1, 51, 1, 255), (1, 108, 1, 255), (1, 115, 1, 255), (1, 95, 1, 255), (1, 105, 1, 255), (1, 53, 1, 255), (1, 110, 1, 255), (1, 39, 1, 255), (1, 116, 1, 255), (1, 95, 1, 255), (1, 102, 1, 255), (1, 52, 1, 255), , 255), (1, 95, 1, 255), (1, 101, 1, 255), (1, 52, 1, 255), (1, 115, 1, 255), (1, 121, 1, 255), (1, 95, 1, 255), (1, 116, 1, 255), (1, 111, 1, 255), (1, 95, 1, 255), (1, 102, 1, 255), (1, 49, 1, 255), (1, 110, 1, 255), (1, 100, 1, 255)
```
Now with a little help with regex we can format this to get the just pixel value i.e. the middle value

Formatted:
```text
70,67,67,84,70,123,72,49,100,100,51,110,95,100,52,116,52,95,49,110,95,112,49,120,51,108,115,95,105,53,110,39,116,95,102,52,110,95,52,110,100,95,101,52,115,121,95,116,111,95,102,49,110,100,33,125,84,70,67,67,84,70,123,72,49,100,100,51,110,95,100,52,116,52,95,49,110,95,112,49,120,51,108,115,95,105,53,110,39,116,95,102,52,110,95,52,110,100,95,101,52,115,121,95,116,111,95,102,49,110,100,33,125,84,70,67,67,84,70,123,72,49,100,100,51,110,95,100,52,116,52,95,49,110,95,112,49,120,51,108,115,95,105,53,110,39,116,95,102,52,110,95,52,110,100,95,101,52,115,121,95,116,111,95,102,49,110,100,33,125,84,70,67,67,84,70,123,72,49,100,100,51,110,95,100,52,116,52,95,49,110,95,112,49,120,51,108,115,95,105,53,110,39,116,95,102,52,110,95,52,110,100,95,101,52,115,121,95,116,111,95,102,49,110,100,33,125,84,70,67,67,84,70,123,72,49,100,100,51,110,95,100,52,116,52,95,49,110,95,112,49,120,51,108,115,95,105,53,110,39,116,95,102,52,110,95,52,110,100,95,101,52,115,121,95,116,111,95,102,49,110,100,33,125,84,70,67,67,84,70,123,72,49,100,100,51,110,95,100,52,116,52,95,49,110,95,112,49,120,51,108,115,95,105,53,110,39,116,95,102,52,110,95,52,110,100,95,101,52,115,121,95,116,111,95,102,49,110,100,33,125
```

Now we just throw this into cyberchef, convert it from Decimal and Walah! The Flag
![CyberChef_Flag](https://i.ibb.co/CtwKF19/2023-07-29-18h39-33.png)

Flag: `TFCCTF{H1dd3n_d4t4_1n_p1x3ls_i5n't_f4n_4nd_e4sy_to_f1nd!}`
